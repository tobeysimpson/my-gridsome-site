{"remainingRequest":"/Users/tobeysimpson/my-gridsome-site/node_modules/babel-loader/lib/index.js??ref--1-1!/Users/tobeysimpson/my-gridsome-site/node_modules/gridsome/app/page-query/fetch.js","dependencies":[{"path":"/Users/tobeysimpson/my-gridsome-site/node_modules/gridsome/app/page-query/fetch.js","mtime":1554172634699},{"path":"/Users/tobeysimpson/my-gridsome-site/node_modules/cache-loader/dist/cjs.js","mtime":1554172634942},{"path":"/Users/tobeysimpson/my-gridsome-site/node_modules/babel-loader/lib/index.js","mtime":1553985690434}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.number.constructor\";\nimport _JSON$stringify from \"/Users/tobeysimpson/my-gridsome-site/node_modules/@babel/runtime-corejs2/core-js/json/stringify\";\nimport _Promise from \"/Users/tobeysimpson/my-gridsome-site/node_modules/@babel/runtime-corejs2/core-js/promise\";\nimport _objectSpread from \"/Users/tobeysimpson/my-gridsome-site/node_modules/@babel/runtime-corejs2/helpers/esm/objectSpread\";\nimport _objectWithoutProperties from \"/Users/tobeysimpson/my-gridsome-site/node_modules/@babel/runtime-corejs2/helpers/esm/objectWithoutProperties\";\n\n/* global GRIDSOME_MODE, GRIDSOME_DATA_DIR */\nimport router from '../router';\nimport { setResults } from './shared';\nimport { unslash } from '../utils/helpers';\nexport default (function (route, query) {\n  if (GRIDSOME_MODE === 'serve') {\n    var _route$params = route.params,\n        page = _route$params.page,\n        params = _objectWithoutProperties(_route$params, [\"page\"]);\n\n    var _router$resolve = router.resolve(_objectSpread({}, route, {\n      params: params\n    })),\n        location = _router$resolve.location;\n\n    return new _Promise(function (resolve, reject) {\n      fetch(process.env.GRAPHQL_ENDPOINT, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: _JSON$stringify({\n          variables: {\n            page: page ? Number(page) : null,\n            path: location.path || route.path\n          },\n          query: query\n        })\n      }).then(function (res) {\n        return res.json();\n      }).then(function (res) {\n        if (res.errors) reject(res.errors[0]);else setResults(route.path, res.data) && resolve(res);\n      }).catch(function (err) {\n        reject(err);\n      });\n    });\n  } else if (GRIDSOME_MODE === 'static') {\n    return new _Promise(function (resolve, reject) {\n      var name = route.name,\n          isIndex = route.meta.isIndex;\n      var path = unslash(name === '*' ? '404' : route.path);\n      var jsonPath = unslash(isIndex === false ? \"\".concat(path, \".json\") : \"\".concat(path, \"/index.json\"));\n      import(\n      /* webpackChunkName: \"data/\" */\n      \"\".concat(GRIDSOME_DATA_DIR, \"/\").concat(jsonPath)).then(function (res) {\n        if (res.errors) reject(res.errors[0]);else setResults(route.path, res.data), resolve(res);\n      }).catch(function (err) {\n        reject(err);\n      });\n    });\n  }\n});",{"version":3,"sources":["/Users/tobeysimpson/my-gridsome-site/node_modules/gridsome/app/page-query/fetch.js"],"names":["router","setResults","unslash","route","query","GRIDSOME_MODE","params","page","resolve","location","reject","fetch","process","env","GRAPHQL_ENDPOINT","method","headers","body","variables","Number","path","then","res","json","errors","data","catch","err","name","isIndex","meta","jsonPath","GRIDSOME_DATA_DIR"],"mappings":";;;;;;;AAAA;AAEA,OAAOA,MAAP,MAAmB,WAAnB;AACA,SAASC,UAAT,QAA2B,UAA3B;AACA,SAASC,OAAT,QAAwB,kBAAxB;AAEA,gBAAe,UAACC,KAAD,EAAQC,KAAR,EAAkB;AAC/B,MAAIC,aAAa,KAAK,OAAtB,EAA+B;AAAA,wBACDF,KAAK,CAACG,MADL;AAAA,QACrBC,IADqB,iBACrBA,IADqB;AAAA,QACZD,MADY;;AAAA,0BAERN,MAAM,CAACQ,OAAP,mBAAoBL,KAApB;AAA2BG,MAAAA,MAAM,EAANA;AAA3B,OAFQ;AAAA,QAErBG,QAFqB,mBAErBA,QAFqB;;AAI7B,WAAO,aAAY,UAACD,OAAD,EAAUE,MAAV,EAAqB;AACtCC,MAAAA,KAAK,CAACC,OAAO,CAACC,GAAR,CAAYC,gBAAb,EAA+B;AAClCC,QAAAA,MAAM,EAAE,MAD0B;AAElCC,QAAAA,OAAO,EAAE;AAAE,0BAAgB;AAAlB,SAFyB;AAGlCC,QAAAA,IAAI,EAAE,gBAAe;AACnBC,UAAAA,SAAS,EAAE;AACTX,YAAAA,IAAI,EAAEA,IAAI,GAAGY,MAAM,CAACZ,IAAD,CAAT,GAAkB,IADnB;AAETa,YAAAA,IAAI,EAAEX,QAAQ,CAACW,IAAT,IAAiBjB,KAAK,CAACiB;AAFpB,WADQ;AAKnBhB,UAAAA,KAAK,EAALA;AALmB,SAAf;AAH4B,OAA/B,CAAL,CAWGiB,IAXH,CAWQ,UAAAC,GAAG;AAAA,eAAIA,GAAG,CAACC,IAAJ,EAAJ;AAAA,OAXX,EAYGF,IAZH,CAYQ,UAAAC,GAAG,EAAI;AACX,YAAIA,GAAG,CAACE,MAAR,EAAgBd,MAAM,CAACY,GAAG,CAACE,MAAJ,CAAW,CAAX,CAAD,CAAN,CAAhB,KACKvB,UAAU,CAACE,KAAK,CAACiB,IAAP,EAAaE,GAAG,CAACG,IAAjB,CAAV,IAAoCjB,OAAO,CAACc,GAAD,CAA3C;AACN,OAfH,EAgBGI,KAhBH,CAgBS,UAAAC,GAAG,EAAI;AACZjB,QAAAA,MAAM,CAACiB,GAAD,CAAN;AACD,OAlBH;AAmBD,KApBM,CAAP;AAqBD,GAzBD,MAyBO,IAAItB,aAAa,KAAK,QAAtB,EAAgC;AACrC,WAAO,aAAY,UAACG,OAAD,EAAUE,MAAV,EAAqB;AAAA,UAC9BkB,IAD8B,GACHzB,KADG,CAC9ByB,IAD8B;AAAA,UAChBC,OADgB,GACH1B,KADG,CACxB2B,IADwB,CAChBD,OADgB;AAEtC,UAAMT,IAAI,GAAGlB,OAAO,CAAC0B,IAAI,KAAK,GAAT,GAAe,KAAf,GAAuBzB,KAAK,CAACiB,IAA9B,CAApB;AACA,UAAMW,QAAQ,GAAG7B,OAAO,CAAC2B,OAAO,KAAK,KAAZ,aAAuBT,IAAvB,uBAAwCA,IAAxC,gBAAD,CAAxB;AAEA;AAAO;AAAP,gBAA0CY,iBAA1C,cAA+DD,QAA/D,GACGV,IADH,CACQ,UAAAC,GAAG,EAAI;AACX,YAAIA,GAAG,CAACE,MAAR,EAAgBd,MAAM,CAACY,GAAG,CAACE,MAAJ,CAAW,CAAX,CAAD,CAAN,CAAhB,KACMvB,UAAU,CAACE,KAAK,CAACiB,IAAP,EAAaE,GAAG,CAACG,IAAjB,CAAV,EAAkCjB,OAAO,CAACc,GAAD,CAA1C;AACN,OAJH,EAKGI,KALH,CAKS,UAAAC,GAAG,EAAI;AACZjB,QAAAA,MAAM,CAACiB,GAAD,CAAN;AACD,OAPH;AAQD,KAbM,CAAP;AAcD;AACF,CA1CD","sourcesContent":["/* global GRIDSOME_MODE, GRIDSOME_DATA_DIR */\n\nimport router from '../router'\nimport { setResults } from './shared'\nimport { unslash } from '../utils/helpers'\n\nexport default (route, query) => {\n  if (GRIDSOME_MODE === 'serve') {\n    const { page, ...params } = route.params\n    const { location } = router.resolve({ ...route, params })\n\n    return new Promise((resolve, reject) => {\n      fetch(process.env.GRAPHQL_ENDPOINT, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          variables: {\n            page: page ? Number(page) : null,\n            path: location.path || route.path\n          },\n          query\n        })\n      })\n        .then(res => res.json())\n        .then(res => {\n          if (res.errors) reject(res.errors[0])\n          else setResults(route.path, res.data) && resolve(res)\n        })\n        .catch(err => {\n          reject(err)\n        })\n    })\n  } else if (GRIDSOME_MODE === 'static') {\n    return new Promise((resolve, reject) => {\n      const { name, meta: { isIndex }} = route\n      const path = unslash(name === '*' ? '404' : route.path)\n      const jsonPath = unslash(isIndex === false ? `${path}.json` : `${path}/index.json`)\n\n      import(/* webpackChunkName: \"data/\" */ `${GRIDSOME_DATA_DIR}/${jsonPath}`)\n        .then(res => {\n          if (res.errors) reject(res.errors[0])\n          else (setResults(route.path, res.data), resolve(res))\n        })\n        .catch(err => {\n          reject(err)\n        })\n    })\n  }\n}\n"]}]}